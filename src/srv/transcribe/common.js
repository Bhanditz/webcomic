!function(){"use strict";!function e(){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",e);function t(){for(var e=document.querySelectorAll(".webcomic-transcripts-toggle .webcomic-transcripts-toggler"),t=document.querySelectorAll(".webcomic-transcribe-cancel-link"),n=0;n<e.length;n++)e[n].dispatchEvent(new Event("change",{bubbles:!0}));for(var r=0;r<t.length;r++){var a=t[r].querySelector(".webcomic-transcribe-link").hash;t[r].style.display="none",window.location.href.match(/\/transcribe\/\d+\/#.+$/)&&window.location.hash===a&&(t[r].style.display=null)}}function n(e,t){var n=e.querySelector('[name="webcomic_transcript_id"]'),r=e.querySelector('[name="webcomic_transcript"]');n.value=t.id,r.value=t.content,function(e,t){if(!e)return;if(e.selectedIndex=-1,!t)return;for(var n=0;n<e.options.length;n++)-1!==t.indexOf(parseInt(e.options[n].value))&&(e.options[n].selected=!0)}(e.querySelector('[name="webcomic_transcript_language[]"]'),t.languages),function(e,t){if(!e)return;for(var n=e.querySelectorAll(".webcomic-transcribe-cancel-link"),r=0;r<n.length;r++)n[r].style.display="none",t&&(n[r].style.display=null)}(document.querySelector(t.hash),t.id),window.location.hash=t.hash,t.id&&r.focus()}document.addEventListener("change",function(e){var t=e.target,n=function(e){var t=e.classList.contains("webcomic-transcripts-toggler"),n=e;if("select"!==n.tagName.toLowerCase()||!t)return;for(;n.tagName&&!n.classList.contains("webcomic-transcripts-toggle");)n=n.parentNode;if(!n.tagName)return;return n}(t);if(!n)return;var r=n.querySelectorAll(".webcomic_transcript.type-webcomic_transcript"),a=t.options[t.selectedIndex].className.match(/webcomic_transcript_\S+-\S+/);if(!r)return;a&&(a=a[0]);for(var c=0;c<r.length;c++)r[c].style.display="none",r[c].classList.contains(a)&&(r[c].style.display=null)}),document.addEventListener("click",function(e){var t=e.target;for(;t.tagName&&"a"!==t.tagName.toLowerCase();)t=t.parentNode;if(!t.tagName||!t.classList.contains("webcomic-transcribe-link"))return;var r=t.href.match(/(?:\/transcribe\/(\d+)\/)?(#.+)$/),a=t.className.match(/webcomic-transcribe-parent-(\d+)/);if(!r||!a)return;var c=document.querySelectorAll("\n\t\t\t".concat(r[2]," form,\n\t\t\t").concat(r[2],' form [name="webcomic_transcript"],\n\t\t\t').concat(r[2],' form [name="webcomic_transcript_id"]\n\t\t\t'));if(3!==c.length)return;e.preventDefault(),function(e,t,r,a,c){if(n(t,{url:e.href,hash:r,id:0,content:"",languages:[]}),!a)return;var o=new FormData,i=new XMLHttpRequest;o.append("action","webcomic_transcribe"),o.append("post",parseInt(a)),o.append("parent",parseInt(c)),i.onreadystatechange=function(){if(4===i.readyState)if(i.responseText){var a=JSON.parse(i.responseText);a.url=e.href,a.hash=r,n(t,a)}else window.location.href=e.href},i.open("POST",webcomicCommonJS.ajaxurl),i.send(o)}(t,c[0],r[2],r[1],a[1])}),t(),new MutationObserver(function(e){for(var n=0;n<e.length;n++)if(e[n].addedNodes.length)for(var r=0;r<e[n].addedNodes.length;r++){var a=e[n].addedNodes[r];a&&a.tagName&&a.classList.contains("webcomic-dynamic")&&t()}}).observe(document.querySelector("body"),{childList:!0,subtree:!0})}()}();
